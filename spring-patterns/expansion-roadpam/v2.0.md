# spring-patterns v2.x 리액티브 & 고성능

## 프로젝트 개요

### 현재 상태 (v1.6)
- **위치**: `spring-patterns/`
- **기술 스택**: Spring Boot 3.2, Java 21, PostgreSQL
- **아키텍처**: 레이어드 CRUD (MVC)
- **완성된 기능**:
  - Spring Security
  - AOP 로깅
  - JPA Repository
  - REST API
  - Spring Cloud Gateway
  - Docker & Production

### 목표 상태 (v2.x)
- **목표**: 블로킹 → 리액티브 전환, 고성능 API
- **핵심 변경**: WebFlux, R2DBC, Virtual Threads

## v2.0.0: WebFlux 전환 & R2DBC (Phase 1)

### 작업 내용
| 순서 | 작업 | 핵심 파일 |
|------|------|----------|
| 2.0.1 | WebFlux 의존성 추가 | `build.gradle` |
| 2.0.2 | R2DBC Repository 전환 | `ProductRepository.java` |
| 2.0.3 | 리액티브 컨트롤러 | `ProductController.java` |
| 2.0.4 | 리액티브 서비스 | `ProductService.java` |
| 2.0.5 | SSE 스트리밍 | `ProductController.java` |

### 커밋 포인트
```bash
git commit -m "feat(deps): migrate from Spring MVC to WebFlux"
git commit -m "feat(repo): convert JPA to R2DBC repositories"
git commit -m "feat(controller): implement reactive controllers with Mono/Flux"
git commit -m "feat(service): add reactive service layer with backpressure"
git commit -m "feat(sse): add Server-Sent Events for product updates"
git tag -a v2.0.0 -m "v2.0.0: WebFlux & R2DBC Migration"
```

## 기술 스택 추가

- **WebFlux**: Spring WebFlux, Project Reactor
- **R2DBC**: r2dbc-postgresql
- **Virtual Threads**: Java 21+
- **Cache**: Spring Cache + Redis

## 성능 요구사항

- API 응답: < 50ms (p99)
- Throughput: 10,000 req/s
- Memory: < 1GB per instance

## 벤치마크

```bash
# wrk 테스트
wrk -t12 -c400 -d30s http://localhost:8080/api/v2/products

# 예상 결과
# Requests/sec: 15000+
# Latency (p99): < 50ms
```

## 학습 자료

- [Spring WebFlux](https://docs.spring.io/spring-framework/reference/web/webflux.html)
- [Project Reactor](https://projectreactor.io/docs/core/release/reference/)
- [Virtual Threads in Spring](https://spring.io/blog/2022/10/11/embracing-virtual-threads)