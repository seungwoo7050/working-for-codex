[역할]
너는 이미 존재하는 프로젝트에 "추가 구현"이 들어간 이후,
문서(CLONE-GUIDE.md, design/)와 snapshot/ 을 일관성 있게 갱신하는 작업을 담당한다.

아래 단계를 반드시 "순서대로", "세분화된 단위"로 수행하라.
여러 단계를 합치거나 건너뛰지 말 것.

[입력 전제]
사용자가 다음 정보를 제공한다고 가정한다.

- BASE_VERSION: v1.3
- ADDITIONAL_REQUIREMENT_DOCS: 추가 구현 요구사항 문서 경로 리스트
  - expansion/not-yet/v1.4.md
  - expansion/not-yet/v2.0.md
  - expansion/not-yet/v2.1.md
  - 각 문서는 하나의 "마이너 버전"에 해당한다.
  - 문서 내부 내용은 너가 "패치 단위"로 쪼개야 한다.

[전체 흐름 개요]
각 마이너 버전(요구사항 문서)마다 아래 과정을 완전히 끝낸 뒤에, 다음 마이너 버전으로 넘어가라.

1) 현재 기준 버전 스냅샷 고정
2) 마이너 버전 선택 및 기존 흐름 파악
3) CLONE-GUIDE.md 패치 단위 갱신
4) design/ 패치 단위 설계 작성
5) 패치 단위 구현 + 빌드 + 테스트 (실패 시 반복)
6) snapshot/ 갱신
7) 최종 정합성 검증

여러 마이너 버전이 주어져도, 위 1~7 단계를
"마이너 버전 1에 대해 전부 완료 → 마이너 버전 2에 대해 전부 완료 → …"
형태로만 진행하라. 마이너 버전들을 섞어서 동시에 처리하지 말 것.

[상세 단계]

1. 현재 기준 버전 스냅샷 고정
  1-1. snapshot/ 디렉터리에서 BASE_VERSION 에 해당하는 스냅샷 존재 여부를 확인한다.
  1-2. 없다면, 현재 코드 상태를 기반으로 BASE_VERSION 스냅샷을 새로 만든다.
       - snapshot/ 하위에 BASE_VERSION 을 식별할 수 있는 디렉터리/파일 구조를 사용한다.
       - 이 단계에서는 코드 변경을 하지 않는다.
  1-3. 이미 존재한다면, 내용을 변경하지 않고 그대로 둔다.

2. 마이너 버전 처리 루프 설정
  2-1. ADDITIONAL_REQUIREMENT_DOCS 리스트를 앞에서부터 순서대로 처리한다.
  2-2. 각 문서를 하나의 "마이너 버전"으로 간주한다.
  2-3. 현재 처리 중인 마이너 버전에 대한 3~7 단계를 모두 끝내기 전에는
       다음 문서(다음 마이너 버전)에 대한 작업을 시작하지 않는다.

3. CLONE-GUIDE.md 패치 단위 갱신 (현재 마이너 버전 기준)
  3-1. 현재 마이너 버전의 요구사항 문서를 읽고,
       구현해야 할 변경 사항을 "패치 단위"로 쪼갠다.
       - 패치 단위는 클론코딩 학습에서 한 번에 구현하기 적당한 크기로 나눈다.
  3-2. 기존 CLONE-GUIDE.md 의 흐름을 존중하면서,
       현재 마이너 버전에 해당하는 패치 목록을 추가한다.
       - 기존에 정의된 버전/패치의 순서를 망가뜨리지 않는다.
       - 새로운 패치는 명확한 ID(예: v1.3-p1, v1.3-p2)와 목적/요약을 포함한다.
  3-3. 이 단계에서는 실제 코드 수정은 하지 않는다.
       문서(가이드)만 갱신한다.

4. design/ 패치 단위 설계 작성 (현재 마이너 버전 기준)
  4-1. 방금 갱신한 CLONE-GUIDE.md 의 패치 목록을 기준으로,
       각 패치에 대응하는 설계 문서를 design/ 하위에 작성 또는 갱신한다.
       - 패치 단위로 설계를 쪼개고, 파일명/섹션 구조에서 패치 ID 가 드러나게 한다.
  4-2. 설계 내용에는 최소한 다음이 포함되도록 한다.
       - 변경되는 책임, 데이터 구조, 인터페이스, 흐름
       - 기존 코드와의 연관성
       - 테스트 관점에서 중요 포인트
  4-3. 이 단계에서도 실제 코드 수정은 하지 않는다.

5. 패치 단위 구현 + 빌드 + 테스트 (실패 시 반복)
  5-1. 현재 마이너 버전의 각 패치에 대해, 아래 과정을 "순차적으로" 수행한다.
       이전 패치가 완전히 끝나기 전에는 다음 패치로 넘어가지 않는다.

       a. 구현
          - 해당 패치에 필요한 최소 범위의 코드만 수정/추가한다.
          - 설계 문서(design/)와 CLONE-GUIDE.md 의 의도를 우선적으로 따른다.

       b. 빌드
          - 프로젝트에서 표준으로 사용하는 빌드 명령을 실행한다.
          - 빌드가 실패하면, 실패 원인을 분석하고 필요한 수정 후 다시 빌드한다.

       c. 테스트
          - 기존 테스트 러너/스크립트를 사용해 테스트를 실행한다.
          - 가능하면 단위 테스트와 통합 테스트를 모두 고려한다.

       d. 실패 시 반복
          - 빌드나 테스트가 실패하면, 원인을 분석하고 코드를 수정한 후
            다시 빌드와 테스트를 반복한다.
          - 자동으로 수정이 불가능한 근본적인 환경/외부 시스템 문제 등
            더 이상 합리적으로 진행할 수 없는 경우가 아니라면,
            실패한 상태로 다음 패치로 넘어가서는 안 된다.

       e. 패치 완료 조건
          - 빌드와 테스트가 모두 통과해야만
            해당 패치를 "완료"된 것으로 간주하고 다음 패치로 넘어간다.

6. snapshot/ 갱신 (현재 마이너 버전 완료 시점)
  6-1. 현재 마이너 버전의 모든 패치 구현이 끝나고,
       빌드/테스트가 모두 통과한 시점을 기준으로 snapshot/ 을 갱신한다.
  6-2. snapshot/ 하위에 현재 마이너 버전 이름을 식별할 수 있는 새로운 스냅샷을 만든다.
       - 기존 스냅샷과 충돌하지 않는 이름을 사용한다.
       - 동일 버전 이름의 스냅샷이 이미 있다면, 덮어쓰지 말고 새 버전 이름을 사용한다.
  6-3. 스냅샷은 이후 클론코딩 학습 시점에 그대로 재현 가능한 형태여야 한다.

7. 최종 정합성 검증
  7-1. 현재까지 작업한 마이너 버전에 대해 다음 네 가지가 서로 모순 없이 일치하는지 확인한다.
       - CLONE-GUIDE.md
       - design/ 하위 설계 문서
       - 실제 코드
       - snapshot/ 구조 및 내용
  7-2. 코드와 문서 사이에 차이가 있으면 다음 원칙을 따른다.
       - 코드가 요구사항과 설계에 부합하고 문서가 틀렸다면,
         CLONE-GUIDE.md 와 design/ 을 수정해 실제 코드를 정확히 설명하게 만든다.
       - 문서가 요구사항을 정확히 반영하고 있고 코드가 틀렸다면,
         코드를 수정해 문서 내용과 일치시킨다.
  7-3. 코드와 문서가 서로 다른 상태로 방치하지 말고,
       "어느 한쪽이 기준인지" 판단한 뒤 나머지를 그에 맞춰 수정한다.
  7-4. 현재 마이너 버전에 대한 정합성 검증이 끝난 후에만,
       다음 마이너 버전(다음 요구사항 문서)에 대한 3~7 단계를 시작한다.

출력/로그 규칙:
- 이 작업은 로컬 파일/디렉터리를 직접 생성·수정하는 것을 기본으로 한다.
- 응답(콘솔 출력)에는 다음 정보만 "요약"으로 남긴다.
  - 생성/갱신한 snapshot/ 하위 디렉터리 이름 목록
  - design/ 에서 추가·변경한 문서 경로와 한 줄 요약
  - 발견된 정합성 문제 요약
- 개별 소스 파일의 전체 내용이나 snapshot 디렉터리의 전체 구조를 그대로 출력하지 않는다.